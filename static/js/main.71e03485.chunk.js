(this.webpackJsonptest_emphasoft=this.webpackJsonptest_emphasoft||[]).push([[0],{128:function(e,t,a){e.exports=a(239)},133:function(e,t,a){},134:function(e,t,a){},198:function(e,t,a){},237:function(e,t,a){},238:function(e,t,a){},239:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(49),s=a.n(c),u=(a(133),a(134),a(8)),o=a(9),l=a(101),m=a(99),i=a(7),f={err:!1,isAuth:!!localStorage.getItem("token")},p={users:[],user:null,editUser:null,createUser:null,error:null},E=Object(o.c)({login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_SUCCESS":return localStorage.setItem("token",t.token),Object(i.a)(Object(i.a)({},e),{},{err:!1,isAuth:!0});case"LOGIN_FAIL":return Object(i.a)(Object(i.a)({},e),{},{isAuth:!1,err:!0});case"LOGOUT":return localStorage.removeItem("token"),Object(i.a)(Object(i.a)({},e),{},{isAuth:!1});default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USERS":return Object(i.a)(Object(i.a)({},e),{},{users:t.users});case"GET_USER":return Object(i.a)(Object(i.a)({},e),{},{user:t.user});case"CREATE_USER":return Object(i.a)(Object(i.a)({},e),{},{createUser:t.user});case"EDIT_USER":return Object(i.a)(Object(i.a)({},e),{},{editUser:t.user});case"CLEAR":return Object(i.a)({},p);case"ERROR":return Object(i.a)(Object(i.a)({},e),{},{error:t.error});default:return e}},form:m.a}),_=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.d,d=Object(o.e)(E,_(Object(o.a)(l.a))),b=function(e){var t=e.children;return r.a.createElement(u.a,{store:d},t)},h=a(15),v=a(10),O=a(35),N="https://emphasoft-test-assignment.herokuapp.com",j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r={method:t,headers:{accept:"application/json","Content-Type":"application/json"}};if(n){var c=localStorage.getItem("token");r=Object(i.a)(Object(i.a)({},r),{},{headers:Object(i.a)(Object(i.a)({},r.headers),{},{Authorization:"Token ".concat(c)})})}return"GET"!==t&&(r=Object(i.a)(Object(i.a)({},r),{},{body:JSON.stringify(a)})),fetch(e,r).then((function(e){if(e.ok)return e.json();throw new Error}))};function g(e){return{type:"ERROR",err:e}}var w=function(e){return function(t){return function(e){return j(N+"/api-token-auth/","POST",e,!1)}(e).then((function(e){t(function(e){return{type:"LOGIN_SUCCESS",token:e}}(e.token))})).catch((function(e){t({type:"LOGIN_FAIL"}),t(Object(O.a)("authForm",{_error:"Can't authorizate"}))}))}},S=function(){return function(e){return j(N+"/api/v1/users/").then((function(t){e(function(e){return{type:"GET_USERS",users:e}}(t))})).catch((function(t){e({type:"LOGIN_FAIL"})}))}},y=function(e){return function(t){return function(e){return j(N+"/api/v1/users/".concat(e,"/"))}(e).then((function(e){t(function(e){return{type:"GET_USER",user:e}}(e))})).catch((function(e){t(g(e))}))}},U=function(e,t){return function(a){return function(e,t){return j(N+"/api/v1/users/".concat(e,"/"),"PUT",t)}(e,t).then((function(e){a(function(e){return{type:"EDIT_USER",user:e}}(e))})).catch((function(e){a(g(e))}))}},A=function(e){return function(t){return function(e){return j(N+"/api/v1/users/","POST",e)}(e).then((function(e){t(function(e){return{type:"CREATE_USER",user:e}}(e))})).catch((function(e){t(g(e))}))}},R=a(97),I=a(98),T=function(e){var t={};return e.username?e.username.length>150?t.username="Must be 150 characters or less":/^[\w.@+-]+$/.test(e.username)||(t.username="Invalid username"):t.username="The field can't be empty",e.password?e.password.length>128?t.password="Must be 128 characters or less":/^(?=.*[A-Z])(?=.*\d).{8,}$/.test(e.password)||(t.password="Invalid password"):t.password="The field can't be empty",e.first_name&&e.first_name.length>30&&(t.first_name="Must be 30 characters or less"),e.last_name&&e.last_name.length>150&&(t.last_name="Must be 150 characters or less"),t},C=function(e){var t=e.meta,a=e.input,n=e.className,c=e.placeholder,s=e.type,u=e.autoComplete;return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",Object.assign({},a,{className:n,placeholder:c,type:s,autoComplete:u})),r.a.createElement("div",{className:"form__error"},t.touched&&t.error&&t.error))},L=(a(198),Object(I.a)({form:"authForm",validate:T})((function(e){return r.a.createElement("div",{className:"auth"},r.a.createElement("div",{className:"container"},r.a.createElement("h2",{className:"auth__title"},"Sign in"),r.a.createElement("form",{className:"auth-form",onSubmit:e.handleSubmit},r.a.createElement("div",{className:"auth-form__item"},r.a.createElement(R.a,{className:"auth-form__input",component:C,type:"text",placeholder:"Username",name:"username",autoComplete:"username"})),r.a.createElement("div",{className:"auth-form__item"},r.a.createElement(R.a,{className:"auth-form__input",component:C,type:"password",placeholder:"Password",name:"password",autoComplete:"current-password"})),r.a.createElement("div",{className:"form__error"},e.error&&e.error),r.a.createElement("button",{className:"button auth-form__button",type:"submit"},"LogIn"))))}))),k=Object(u.b)((function(e){return{isAuth:e.login.isAuth}}),(function(e){return{login:function(t,a){e(w(t))}}}))((function(e){if(e.isAuth)return r.a.createElement(v.a,{to:"/"});return r.a.createElement(L,{onSubmit:function(t){e.login(t)}})}));a(237);function F(e){return r.a.createElement("div",{className:"forms"},r.a.createElement("div",{className:"wrapper"},r.a.createElement("h2",null,e.title),r.a.createElement("form",{className:"form",onSubmit:e.handleSubmit},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement(R.a,{className:"form__input",component:C,type:"text",name:"username"}),r.a.createElement("label",{htmlFor:"first_name"},"Firstname"),r.a.createElement(R.a,{className:"form__input",component:C,type:"text",name:"first_name"}),r.a.createElement("label",{htmlFor:"last_name"},"Lastname"),r.a.createElement(R.a,{className:"form__input",component:C,type:"text",name:"last_name"}),r.a.createElement("label",{htmlFor:"password"},"New password"),r.a.createElement(R.a,{className:"form__input",component:C,type:"text",name:"password"}),r.a.createElement("span",{className:"form__active"},r.a.createElement("label",{htmlFor:"is_active"},"Is active"),r.a.createElement(R.a,{className:"form__input",component:"input",type:"checkbox",name:"is_active"})),r.a.createElement("div",{className:"form__buttons"},r.a.createElement("button",{className:"button form__button",type:"submit"},"Save"),r.a.createElement(h.b,{to:"/"},r.a.createElement("button",{className:"button form__button form__button_cancel"},"Cancel"))))))}var G=function(e,t){var a,n,r,c;return{initialValues:{username:(null===(a=t.user)||void 0===a?void 0:a.username)||"",first_name:(null===(n=t.user)||void 0===n?void 0:n.first_name)||"",last_name:(null===(r=t.user)||void 0===r?void 0:r.last_name)||"",is_active:void 0===(null===(c=t.user)||void 0===c?void 0:c.is_active)||t.user.is_active,password:""}}},x=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(u.b)(G)(Object(I.a)({form:e,enableReinitialize:t,validate:T})(F))},D=x("createForm"),M=Object(u.b)((function(e){return{createUser:e.users.createUser}}),(function(e){return{create:function(t){e(A(t))},clear:function(){e({type:"CLEAR"})}}}))((function(e){var t=e.createUser,a=e.clear,c=e.create;if(Object(n.useEffect)((function(){a()}),[t,a]),t)return r.a.createElement(v.a,{to:"/"});return r.a.createElement(D,{title:"Create user",onSubmit:function(e){c(e)}})})),P=x("editForm",!0),z=Object(u.b)((function(e){return{user:e.users.user,editUser:e.users.editUser}}),(function(e){return{get:function(t){e(y(t))},edit:function(t,a){e(U(t,a))},clear:function(){e({type:"CLEAR"})}}}))((function(e){var t=e.get,a=e.match,c=e.edit,s=e.user,u=e.editUser,o=e.clear;if(Object(n.useEffect)((function(){o()}),[u,o]),Object(n.useEffect)((function(){t(a.params.id)}),[a.params.id,t]),u)return r.a.createElement(v.a,{to:"/"});return s&&r.a.createElement(P,{title:"Edit username",user:s,onSubmit:function(e){c(a.params.id,e)}})})),J=function(){return r.a.createElement("div",{className:"create"},r.a.createElement("div",{className:"wrapper"},r.a.createElement(h.b,{className:"button",to:"/create"},r.a.createElement("button",{className:"button form__button"},"Add user"))))},$=(a(238),Object(u.b)(null,(function(e){return{logout:function(){e({type:"LOGOUT"})},clear:function(){e({type:"CLEAR"})}}}))((function(e){return r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"wrapper header__wrapper"},r.a.createElement("h2",{className:"header__title"},"Users list"),r.a.createElement("button",{className:"button header__button",onClick:function(){e.logout(),e.clear()}},"Logout")))}))),B=(a(96),function(){return r.a.createElement("div",{className:"users__title"},r.a.createElement("span",{className:"users__id"},"ID"),r.a.createElement("span",{className:"users__name"},"Firstname"),r.a.createElement("span",{className:"users__name"},"Lastname"),r.a.createElement("span",{className:"users__name"},"Username"),r.a.createElement("span",{className:"users__button"}))}),V=function(e){return r.a.createElement("li",{className:"users__item"},r.a.createElement("span",{className:"users__id"},e.user.id),r.a.createElement("span",{className:"users__name"},e.user.first_name?e.user.first_name:"-"),r.a.createElement("span",{className:"users__name"},e.user.last_name?e.user.last_name:"-"),r.a.createElement("span",{className:"users__name"},e.user.username),r.a.createElement(h.b,{to:"/users/".concat(e.user.id)},r.a.createElement("button",{className:"button users__button"},"Edit")))},W=Object(u.b)((function(e){return{users:e.users.users}}))((function(e){var t=e.users.map((function(e){return r.a.createElement(V,{key:e.id,user:e})}));return r.a.createElement("div",{className:"users"},r.a.createElement("div",{className:"wrapper"},r.a.createElement(B,null),r.a.createElement("ul",null,t)))})),X=Object(u.b)(null,(function(e){return{getUsers:function(){e(S())}}}))((function(e){var t=e.getUsers;return Object(n.useEffect)((function(){t()}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement($,null),r.a.createElement(J,null),r.a.createElement(W,null))})),Z=Object(u.b)((function(e){return{isAuth:e.login.isAuth}}))((function(e){return e.isAuth?r.a.createElement(v.b,e):r.a.createElement(v.a,{to:"/login"})}));var q=function(){return r.a.createElement(h.a,{basename:"/test_emphasoft"},r.a.createElement(Z,{path:"/",exact:!0,component:X}),r.a.createElement(Z,{path:"/users/:id",component:z}),r.a.createElement(v.b,{path:"/login",exact:!0,component:k}),r.a.createElement(Z,{path:"/create",exact:!0,component:M}))},H=function(){return r.a.createElement(b,null,r.a.createElement(q,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(H,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},96:function(e,t,a){}},[[128,1,2]]]);
//# sourceMappingURL=main.71e03485.chunk.js.map